<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ADU Canada | Productized Housing</title>
  <meta name="description" content="Productized, architecturally refined backyard homes delivered through a repeatable system that prioritizes clarity, speed, and budget certainty." />
  <link rel="stylesheet" href="/assets/css/index.css" />
  <script defer data-domain="aducanada.com" src="/assets/analytics/plausible.js"></script>
</head>
<body>
  <div id="root"></div>
  <script type="module" src="/assets/js/index.js"></script>

<style>
  /* TEMP: hard-hide testimonials and trusted-by sections */
  #testimonials, .testimonials, .testimonial, .testimonial-grid, .testimonial-card,
  [data-section="testimonials"], [data-testid="testimonials"],
  [id*="testimonial" i], [class*="testimonial" i] {
    display:none !important;
    visibility:hidden !important;
    height:0 !important;
    overflow:hidden !important;
  }
</style>
<script>
(function(){
  const PHONE_NEW = "980-222-4469";
  const mailtoConsult = "mailto:sales@aducanada.com?subject=ADU%20Canada%20-%20Schedule%20a%20Consultation";
  const mailtoPrice = "mailto:sales@aducanada.com?subject=ADU%20Canada%20-%20Get%20Your%20Price";
  const normalize = (s) => (s||"").replace(/\s+/g," ").trim();

  function isIn(el, selector) {
    try { return !!el.closest(selector); } catch(e) { return false; }
  }

  function hideByHeading(rxList) {
    document.querySelectorAll("h1,h2,h3,h4").forEach(h => {
      const t = normalize(h.textContent);
      if (!t) return;
      for (const rx of rxList) {
        if (rx.test(t)) {
          const c = h.closest("section,div");
          if (c) c.style.display = "none";
          break;
        }
      }
    });
  }

  function reduceCTAs() {
    // Convert/remove Contact Sales everywhere
    Array.from(document.querySelectorAll("a,button")).forEach(el => {
      const t = normalize(el.textContent);
      if (!t) return;
      if (/^contact sales$/i.test(t)) {
        if (isIn(el, "footer")) {
          // Hide any footer Contact Sales buttons; keep email/phone links instead
          el.style.display = "none";
        } else {
          el.textContent = "Schedule a Free Consultation";
          if (el.tagName.toLowerCase() === "a") el.setAttribute("href", mailtoConsult);
        }
      }
    });

    // Keep only ONE mid-page consultation CTA outside nav/hero/footer
    let midKept = false;
    Array.from(document.querySelectorAll("a,button")).forEach(el => {
      const t = normalize(el.textContent);
      if (!t) return;
      const isConsult = /schedule.*consultation/i.test(t) || /^schedule free consultation$/i.test(t);
      if (!isConsult) return;
      if (isIn(el, "nav") || isIn(el, ".hero") || isIn(el, "header") || isIn(el, "footer")) return;
      if (!midKept) { midKept = true; return; }
      el.style.display = "none";
    });
  }

  function wireCTAs() {
    const rules = [
      { match: /schedule.*consultation|schedule free consultation/i, href: mailtoConsult },
      { match: /get (your )?price|get price/i, href: mailtoPrice },
      { match: /get roi estimate|roi calculator|roi/i, href: "/roi" },
    ];

    function closestClickable(node) {
      let el = node;
      for (let i=0;i<10 && el;i++) {
        const tag = (el.tagName||"").toLowerCase();
        if (tag==="a" || tag==="button") return el;
        el = el.parentElement;
      }
      return null;
    }

    document.addEventListener("click", function(e){
      const el = closestClickable(e.target);
      if (!el) return;
      const text = normalize(el.textContent);
      if (!text) return;
      for (const r of rules) {
        if (r.match.test(text)) {
          e.preventDefault(); e.stopPropagation();
          if (typeof e.stopImmediatePropagation === "function") e.stopImmediatePropagation();
          window.location.href = r.href;
          return;
        }
      }
    }, true);
  }

  function replacePhone() {
    const olds = ["404-555-0123","(404) 555-0123","404.555.0123","404 555 0123"];
    const walker = document.createTreeWalker(document.body, NodeFilter.SHOW_TEXT);
    const nodes = [];
    while (walker.nextNode()) nodes.push(walker.currentNode);
    nodes.forEach(n => {
      let v = n.nodeValue || "";
      olds.forEach(o => { if (v.includes(o)) v = v.split(o).join(PHONE_NEW); });
      if (v !== n.nodeValue) n.nodeValue = v;
    });
  }

  function runAll() {
    hideByHeading([/trusted by toronto homeowners/i, /trusted by .*homeowners/i, /testimonials/i]);
    reduceCTAs();
    replacePhone();
  }

  wireCTAs();
  if (document.readyState === "loading") document.addEventListener("DOMContentLoaded", runAll);
  else runAll();
  setTimeout(runAll, 700);
  setTimeout(runAll, 1600);
  new MutationObserver(runAll).observe(document.body, {childList:true, subtree:true});
})();
</script>

</body>
</html>
